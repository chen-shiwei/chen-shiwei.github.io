## 用户态和内核态

- 为了控制计算机资源，并提供给上层应用程序运行环境

- 保护内核安全，对资源操作设限，必须通过内核操作

  
### 内核空间

- 网络栈
  - socket
  - 网络协议
- 进程管理
  - 多任务
  - 线程调度
- 内存管理
  - 虚拟内存






# IO 

IO 是服务器之间经过网络、系统内核空间最后用户空间的数据传输操作，因为经过大量的多次的数据拷贝会造成性能消耗也是现代网络应用之间的性能瓶颈。

Linux 标准IO接口是基于数据拷贝的，IO操作会导致操作系统内核空间地址额的缓冲区和用户态空间地址缓冲区之间进行传输。

IO 数据传输过程中依赖CPU去进行数据拷贝操作，这会造成极大的系统开销。zero-copy 可以解决此问题。



缓冲区

- page cache
  - 读磁盘
    - 内核先检查pageCache是否已缓存，若是直接返回，否读磁盘再缓存
  - 写磁盘
    - 直接写缓存，然后将pageCache 标记为dirty，添加到dirtyList，然后直接返回，内核定期会把dirtyList页缓存刷到磁盘，保证一致性
  - 会有页面置换算法LRU定期淘汰旧的页面，加载新页面
- buffer cache
  - 粒度更细的设备块缓存



## ZERO-COPY

